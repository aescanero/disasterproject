---
- name: Change file ownership, group and permissions
  delegate_to: localhost
  run_once: true
  file:
    path: "{{ ansible_ssh_private_key_file }}"
    mode: '0600'

- name: Wait for start to complete
  wait_for_connection:
    connect_timeout: 20
    sleep: 5
    delay: 5
    timeout: 300
  vars:
    ansible_host: "{{ vm_ip }}"
    warn: no

- name: Obtain vm information
  setup:
  vars:
    ansible_host: "{{ vm_ip }}"
    warn: no

- name: Hostname Configuration
  command: hostnamectl set-hostname "{{ inventory_hostname }}"
  vars:
    ansible_host: "{{ vm_ip }}"
...
